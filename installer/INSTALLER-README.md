# Инструкции по созданию инсталлятора FlashCard App

## Обзор файлов инсталлятора

В папке `installer` находятся следующие файлы:

- **`Install.bat`** - Простой batch файл для запуска установки
- **`Install-FlashCardApp.ps1`** - PowerShell скрипт установки
- **`FlashCardApp-Setup.iss`** - Скрипт Inno Setup для создания профессионального инсталлятора
- **`INSTALLER-README.md`** - Данный файл с инструкциями

## Способы создания инсталлятора

### 1. Простая установка через PowerShell (Рекомендуется)

**Требования:**
- Windows PowerShell 5.1 или выше
- Права администратора

**Использование:**
1. Дважды щелкните на `Install.bat`
2. Следуйте инструкциям на экране
3. При запросе UAC нажмите "Да"

**Что делает:**
- Устанавливает приложение в `C:\Program Files\FlashCardApp`
- Создает ярлык на рабочем столе
- Создает ярлык в меню "Пуск"
- Регистрирует приложение в "Программы и компоненты"
- Создает деинсталлятор

### 2. Профессиональный инсталлятор через Inno Setup

**Требования:**
- [Inno Setup](https://jrsoftware.org/isinfo.php) версии 6.0 или выше

**Создание инсталлятора:**
1. Скачайте и установите Inno Setup
2. Откройте `FlashCardApp-Setup.iss` в Inno Setup Compiler
3. Нажмите "Build" → "Compile"
4. Готовый инсталлятор будет создан в папке `dist`

**Преимущества Inno Setup:**
- Профессиональный интерфейс
- Поддержка множества языков
- Встроенная проверка зависимостей
- Цифровая подпись (если настроена)
- Меньший размер итогового файла

## Структура проекта для инсталлятора

```
FlashCardApp/
├── publish/
│   ├── FlashCardApp.exe     # Основное приложение
│   └── FlashCardApp.pdb     # Отладочные символы
├── installer/
│   ├── Install.bat          # Batch файл запуска
│   ├── Install-FlashCardApp.ps1  # PowerShell инсталлятор
│   ├── FlashCardApp-Setup.iss    # Inno Setup скрипт
│   └── INSTALLER-README.md  # Инструкции
├── dist/                    # Выходные файлы инсталлятора
├── assets/                  # Ресурсы (иконки, изображения)
├── README.md               # Документация приложения
└── LICENSE.txt             # Лицензия
```

## Параметры установки

### PowerShell инсталлятор

```powershell
# Установка в стандартную папку
.\Install-FlashCardApp.ps1

# Установка в пользовательскую папку
.\Install-FlashCardApp.ps1 -InstallPath "C:\MyApps\FlashCardApp"

# Тихая установка (без диалогов)
.\Install-FlashCardApp.ps1 -Silent
```

## Удаление приложения

### Через Панель управления
1. Откройте "Программы и компоненты"
2. Найдите "FlashCard App"
3. Нажмите "Удалить"

### Через PowerShell
```powershell
# Если установлено в стандартную папку
& "C:\Program Files\FlashCardApp\Uninstall.ps1"
```

## Дополнительные файлы

Для полноценного инсталлятора рекомендуется создать:

### LICENSE.txt
```text
MIT License

Copyright (c) 2025 FlashCard App Team

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction...
```

### assets/icon.ico
- Иконка приложения для отображения в инсталляторе
- Рекомендуемые размеры: 16x16, 32x32, 48x48, 256x256

## Часто задаваемые вопросы

**Q: Нужно ли устанавливать .NET отдельно?**
A: Нет, приложение скомпилировано как self-contained, все зависимости включены.

**Q: Можно ли установить без прав администратора?**
A: PowerShell инсталлятор требует права администратора. Для установки в пользовательскую папку измените параметр `InstallPath`.

**Q: Как обновить приложение?**
A: Запустите новый инсталлятор, он автоматически обновит существующую установку.

**Q: Где хранятся данные пользователя?**
A: База данных и настройки сохраняются в `%APPDATA%\FlashCardApp` и не удаляются при деинсталляции.

## Устранение неполадок

### Ошибка "Execution Policy"
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### Ошибка "Не удается найти файл"
- Убедитесь, что приложение собрано командой `dotnet publish`
- Проверьте наличие файла `publish/FlashCardApp.exe`

### Проблемы с правами доступа
- Запустите командную строку от имени администратора
- Убедитесь, что UAC включен и работает корректно

## Создание портативной версии

Для создания портативной версии:
1. Скопируйте файл `publish/FlashCardApp.exe` в любую папку
2. Создайте рядом файл `portable.txt` (пустой)
3. Приложение будет использовать локальную папку для данных

## Цифровая подпись

Для подписи инсталлятора:
1. Получите сертификат Code Signing
2. Добавьте в Inno Setup скрипт:
```ini
[Setup]
SignTool=signtool
```
3. Настройте signtool с вашим сертификатом 